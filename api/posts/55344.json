{"title":"图片隐写","slug":"图片隐写","date":"2021-02-09","updated":"2021-02-09","comments":true,"path":"api/posts/55344.json","excerpt":null,"cover":"/images/image-20210209200549424.png","covers":["/images/image-20210209200549424.png","/images/image-20210209202404086.png","/images/image-20210209203041076.png","/images/image-20210209203315763.png","/images/image-20210209203552735.png","/images/image-20210209222755980.png","/images/aaa.gif","/images/image-20210209223344536.png","/images/image-20210209223840204.png","/images/image-20210209223902146.png","/images/image-20210209223927619.png","/images/pngcheck.png","/images/image-20210209225659056.png","/images/image-20210209225342521.png"],"content":"<h1 id=\"隐写图片\"><a href=\"# 隐写图片\" class=\"headerlink\" title=\"隐写图片\"></a>隐写图片 </h1><p>Misc 为英文 miscellaneous 的前四个字母，<br> 杂项、混合体、大杂烩的意思。<br>主要类型：<br>1. 数据编码 / 图形密码<br>2. 图片隐写<br>3. 音频 &amp; 视频隐写</p>\n<p>4. 流量分析<br>5. 内存取证 6. 游戏隐写.</p>\n<h2 id=\"使用工具：010editor；kali\"><a href=\"# 使用工具：010editor；kali\" class=\"headerlink\" title=\"使用工具：010editor；kali\"></a>使用工具：010editor；kali</h2><h2 id=\"图片隐写分类\"><a href=\"# 图片隐写分类\" class=\"headerlink\" title=\"图片隐写分类\"></a>图片隐写分类 </h2><p> 属性</p>\n<p>文件末尾藏字符串</p>\n<p>文件包含</p>\n<p>修改文件头</p>\n<p>GIF</p>\n<p>PNG(bmp)</p>\n<p>jpg</p>\n<p>双图隐写</p>\n<p>stegpy</p>\n<p>silenteye</p>\n<h2 id=\"详细分类\"><a href=\"# 详细分类\" class=\"headerlink\" title=\"详细分类\"></a>详细分类 </h2><h3 id=\"右击属性\"><a href=\"# 右击属性\" class=\"headerlink\" title=\"右击属性\"></a> 右击属性</h3><p><img src=\"/images/image-20210209200549424.png\" alt=\"image-20210209200549424\"></p>\n<h3 id=\"文件十六进制藏有字符串\"><a href=\"# 文件十六进制藏有字符串\" class=\"headerlink\" title=\"文件十六进制藏有字符串\"></a>文件十六进制藏有字符串</h3><p><img src=\"/images/image-20210209202404086.png\" alt=\"image-20210209202404086\"></p>\n<h3 id=\"文件包含\"><a href=\"# 文件包含\" class=\"headerlink\" title=\"文件包含\"></a>文件包含</h3><p>binwalk 分离文件</p>\n<p><img src=\"/images/image-20210209203041076.png\" alt=\"image-20210209203041076\"></p>\n<p>可以看到效果从 271007 块偏移开始就是另一张 jpg</p>\n<p><strong>使用 foremost 工具分离</strong></p>\n<p>foremost 是一个基于文件文件头和尾部信息以及文件的内建数据结构恢复文件的命令行工具，win 可以下载地址，Linux 可以 <br> 通过下面命令安装 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install foremost</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/image-20210209203315763.png\" alt=\"image-20210209203315763\"></p>\n<p>安装 foremost 后你可以使用 foremost -help 查看使用帮助，这里最简单分离文件的命令为：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">foremost carter.jpg </span><br></pre></td></tr></table></figure>\n<p>当我们使用这行命令后，foremost 会自动生成 output 目录存放分离出文件：</p>\n<p><img src=\"/images/image-20210209203552735.png\" alt=\"image-20210209203552735\"></p>\n<p>可以得到隐藏图片</p>\n<h3 id=\"修改文件头\"><a href=\"# 修改文件头\" class=\"headerlink\" title=\"修改文件头\"></a>修改文件头</h3><p><img src=\"/images/image-20210209222755980.png\" alt=\"image-20210209222755980\"></p>\n<blockquote>\n<p>JPEG (jpg)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：FFD8FF</p>\n<p>PNG (png)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：89504E47</p>\n<p>GIF (gif)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：47494638</p>\n<p>TIFF (tif)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：49492A00</p>\n<p>Windows Bitmap (<a href=\"http://baike.baidu.com/view/7671.htm\">bmp</a>)，文件头：424D</p>\n<p>CAD (dwg)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：41433130</p>\n<p>Adobe Photoshop (psd)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：38425053</p>\n<p>Rich Text Format (rtf)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：7B5C727466</p>\n<p>XML (xml)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：3C3F786D6C</p>\n<p>HTML (html)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：68746D6C3E</p>\n<p>Email [thorough only] (eml)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：44656C69766572792D646174653A</p>\n<p>Outlook Express (dbx)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：CFAD12FEC5FD746F</p>\n<p>Outlook (pst)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：2142444E</p>\n<p>MS Word/Excel (xls.or.doc)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：D0CF11E0</p>\n<p>MS Access (mdb)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：5374616E64617264204A</p>\n<p>WordPerfect (wpd)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：FF575043</p>\n<p>Adobe Acrobat (pdf)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：255044462D312E</p>\n<p>Quicken (qdf)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：AC9EBD8F</p>\n<p>Windows Password (pwl)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：E3828596</p>\n<p>ZIP Archive (zip)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：504B0304</p>\n<p>RAR Archive (rar)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：52617221</p>\n<p>Wave (wav)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：57415645</p>\n<p>AVI (avi)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：41564920</p>\n<p>Real Audio (ram)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：2E7261FD</p>\n<p>Real Media (rm)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：2E524D46</p>\n<p>MPEG (mpg)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：000001BA</p>\n<p>MPEG (mpg)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：000001B3</p>\n<p>Quicktime (mov)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：6D6F6F76</p>\n<p>Windows Media (asf)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：3026B2758E66CF11</p>\n<p>MIDI (mid)， <a href=\"http://baike.baidu.com/view/345685.htm\">文件 </a> 头：4D546864</p>\n</blockquote>\n<h3 id=\"GIF\"><a href=\"#GIF\" class=\"headerlink\" title=\"GIF\"></a>GIF</h3><p>打开图片</p>\n<p><img src=\"/images/aaa.gif\" alt=\"aaa\"></p>\n<p>有字母一闪而过</p>\n<p>用 010editor 打开发现文件头没有问题 为 gif</p>\n<p><img src=\"/images/image-20210209223344536.png\" alt=\"image-20210209223344536\"></p>\n<p>此时用<u><strong>Namo_Gif</strong></u></p>\n<p><img src=\"/images/image-20210209223840204.png\" alt=\"image-20210209223840204\"></p>\n<p><img src=\"/images/image-20210209223902146.png\" alt=\"image-20210209223902146\"></p>\n<p><img src=\"/images/image-20210209223927619.png\" alt=\"image-20210209223927619\"></p>\n<p>可得 flag。</p>\n<h3 id=\"png（bmp）\"><a href=\"#png（bmp）\" class=\"headerlink\" title=\"png（bmp）\"></a>png（bmp）</h3><p><img src=\"/images/pngcheck.png\" alt=\"pngcheck\"></p>\n<p>zlib(010/pngcheck)<br>IHDR、IDAT<br>lsb 隐写 /lsb 加密（zsteg/stegsolve）<br>wbs43open（bmp）</p>\n<p><img src=\"/images/image-20210209225659056.png\" alt=\"image-20210209225659056\"></p>\n<p>使用 checkpng 检查图片结构是否存在问题，发现有一些异常的 IDAT 块。</p>\n<p><img src=\"/images/image-20210209225342521.png\" alt=\"image-20210209225342521\"></p>\n<p>可以看到 keyword</p>\n<p><strong>BINWALK</strong></p>\n<p>关于 binwalk 安装可以参考<a href=\"https://www.cnblogs.com/pcat/p/5256288.html\">https://www.cnblogs.com/pcat/p/5256288.html</a></p>\n<h3 id=\"JPG\"><a href=\"#JPG\" class=\"headerlink\" title=\"JPG\"></a>JPG</h3><p>jphide(jphs）<br>steghide<br>steghide extract -sf good- 已合并.jpg -p 123456<br>stegdetect<br>stegdetect.exe -tjopi -s1000.0 *.jpg （查看图片隐写方式）<br>stegbreak -r rules.ini -f password.txt -t p *.jpg（爆破密码）<br>outguess<br>outguess -k “key” -r 文件名 -t 保存的文件名 <br>F5-steganography<br>java Extract F5.jpg -e misc -p  11111<br> 水印(单图)(工具 +Java 盲水印)</p>\n<h3 id=\"双图隐写（XOR- 脚本（三个））\"><a href=\"# 双图隐写（XOR- 脚本（三个））\" class=\"headerlink\" title=\"双图隐写（XOR/ 脚本（三个））\"></a>双图隐写（XOR/ 脚本（三个））</h3><h3 id=\"stegpy（啥都能藏 -JPG\"><a href=\"#stegpy（啥都能藏 -JPG\" class=\"headerlink\" title=\"stegpy（啥都能藏.JPG\"></a>stegpy（啥都能藏.JPG</h3><h3 id=\"silenteye- 同上\"><a href=\"#silenteye- 同上\" class=\"headerlink\" title=\"silenteye(同上\"></a>silenteye(同上</h3>","url":"/posts/55344/","min2read":2,"word4post":679,"prev_post":null,"next_post":{"title":"黑苹果 win 双系统安装","url":"/posts/43789/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"隐写图片\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">隐写图片 </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"使用工具：010editor；kali\" href = \"#\"><span class=\"toc-number\">1.1.</span> <span class=\"toc-text\">使用工具：010editor；kali</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"图片隐写分类\" href = \"#\"><span class=\"toc-number\">1.2.</span> <span class=\"toc-text\">图片隐写分类 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" data-id=\"详细分类\" href = \"#\"><span class=\"toc-number\">1.3.</span> <span class=\"toc-text\">详细分类 </span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"右击属性\" href = \"#\"><span class=\"toc-number\">1.3.1.</span> <span class=\"toc-text\"> 右击属性</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"文件十六进制藏有字符串\" href = \"#\"><span class=\"toc-number\">1.3.2.</span> <span class=\"toc-text\">文件十六进制藏有字符串</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"文件包含\" href = \"#\"><span class=\"toc-number\">1.3.3.</span> <span class=\"toc-text\">文件包含</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"修改文件头\" href = \"#\"><span class=\"toc-number\">1.3.4.</span> <span class=\"toc-text\">修改文件头</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"GIF\" href = \"#\"><span class=\"toc-number\">1.3.5.</span> <span class=\"toc-text\">GIF</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"png（bmp）\" href = \"#\"><span class=\"toc-number\">1.3.6.</span> <span class=\"toc-text\">png（bmp）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"JPG\" href = \"#\"><span class=\"toc-number\">1.3.7.</span> <span class=\"toc-text\">JPG</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"双图隐写（XOR- 脚本（三个））\" href = \"#\"><span class=\"toc-number\">1.3.8.</span> <span class=\"toc-text\">双图隐写（XOR&#x2F; 脚本（三个））</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"stegpy（啥都能藏 -JPG\" href = \"#\"><span class=\"toc-number\">1.3.9.</span> <span class=\"toc-text\">stegpy（啥都能藏.JPG</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" data-id=\"silenteye- 同上\" href = \"#\"><span class=\"toc-number\">1.3.10.</span> <span class=\"toc-text\">silenteye(同上</span></a></li></ol></li></ol></li></ol>","categories":[],"tags":[]}